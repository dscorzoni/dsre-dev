<!doctype html><html lang=pt dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Carregando dados do Excel e CSV | dsre.dev</title>
<meta name=keywords content="basico,excel,google sheets"><meta name=description content="
      
    


Neste artigo vamos ver como carregar dados externos no R, seja por arquivos separados por vírgula (.csv - Comma Separated Values) ou por arquivos do Excel (.xlsx). Vamos começar criando um arquivo no Google Sheets para facilitar o acompanhamento deste tutorial:"><meta name=author content="Danilo Scorzoni Ré"><link rel=canonical href=https://dsre.dev/blog/05-carregando-dados-csv-excel/><meta name=msvalidate.01 content="EB3E11732C95347992D26E865A944A45"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://dsre.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://dsre.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://dsre.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://dsre.dev/apple-touch-icon.png><link rel=mask-icon href=https://dsre.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=pt href=https://dsre.dev/blog/05-carregando-dados-csv-excel/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://dsre.dev/blog/05-carregando-dados-csv-excel/"><meta property="og:site_name" content="dsre.dev"><meta property="og:title" content="Carregando dados do Excel e CSV"><meta property="og:description" content=" Neste artigo vamos ver como carregar dados externos no R, seja por arquivos separados por vírgula (.csv - Comma Separated Values) ou por arquivos do Excel (.xlsx). Vamos começar criando um arquivo no Google Sheets para facilitar o acompanhamento deste tutorial:"><meta property="og:locale" content="pt-br"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-11-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-15T00:00:00+00:00"><meta property="article:tag" content="Basico"><meta property="article:tag" content="Excel"><meta property="article:tag" content="Google Sheets"><meta name=twitter:card content="summary"><meta name=twitter:title content="Carregando dados do Excel e CSV"><meta name=twitter:description content="
      
    


Neste artigo vamos ver como carregar dados externos no R, seja por arquivos separados por vírgula (.csv - Comma Separated Values) ou por arquivos do Excel (.xlsx). Vamos começar criando um arquivo no Google Sheets para facilitar o acompanhamento deste tutorial:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://dsre.dev/blog/"},{"@type":"ListItem","position":2,"name":"Carregando dados do Excel e CSV","item":"https://dsre.dev/blog/05-carregando-dados-csv-excel/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Carregando dados do Excel e CSV","name":"Carregando dados do Excel e CSV","description":" Neste artigo vamos ver como carregar dados externos no R, seja por arquivos separados por vírgula (.csv - Comma Separated Values) ou por arquivos do Excel (.xlsx). Vamos começar criando um arquivo no Google Sheets para facilitar o acompanhamento deste tutorial:\n","keywords":["basico","excel","google sheets"],"articleBody":" Neste artigo vamos ver como carregar dados externos no R, seja por arquivos separados por vírgula (.csv - Comma Separated Values) ou por arquivos do Excel (.xlsx). Vamos começar criando um arquivo no Google Sheets para facilitar o acompanhamento deste tutorial:\nNesta planilha temos dados de nome e salários em duas colunas com 5 registros, semelhante aos dados do artigo anterior, mas são invés de adicionarmos os dados manualmente no R, vamos utilizar um arquivo externo.\nApós preparar a tabela, você pode exportar o arquivo do Google Sheets escolhando um formato. Para isso, clique no menu Arquivo \u003e Baixar \u003e Valores separados por vírgulas (.csv) OU Microsoft Excel (.xlsx). Nesse artigo vou mostrar como importar nos dois formatos.\nAntes de carregar, como encontrar seus arquivos Existe uma função no R que abre uma caixa de diálogo que auxilia você a encontrar um arquivo no seu computador. Trata-se da função file.choose(). O retorno dela é o caminho completo do arquivo escolhido no computador. Então você pode utilizar essa função em conjunto com as demais funções de carregamento de arquivos.\nAssista ao vídeo no topo deste artigo para ver essa função em ação.\nCarregando arquivos CSV Vamos começar carregando o arquivo CSV então. Após baixá-lo do Google Sheets, basta utilizar os seguintes comandos:\n\u003e dados_csv = read.csv(file.choose()) \u003e dados_csv nome salario 1 João 1000 2 Maria 2500 3 Daniel 2000 4 Aline 3000 5 Mariana 3500 IMPORTANTE: Caso seu arquivo possua números com casas decimais, você precisa verificar como está a configuração do seu computador. Abra o arquivo em um editor de textos como o Bloco de Notas e verifique a estrutura do arquivo. Caso as casas decimais sejam representadas por pontos (.) como no sistema inglês de unidades, você pode usar a função read.csv(), caso as casas decimais sejam representadas por vírgulas (,) como no sistema internacional de unidades, você deve utilizar a função read.csv2(). Isso é fundamental para evitar que o R misture as vírgulas que separam casas decimais com as vírgulas que separam as colunas. Quando a casa decimal é especificada pela vírgula, as colunas serão separadas por ponto-e-vírgula (;).\nAlém de verificar se os dados foram carregados de forma correta, é importante também verificar se os tipos estão corretos. Então, para isso, vamos utilizar a função str() já citada nos artigos anteriores para conhecer a estrutura do data frame:\n\u003e str(dados_csv) 'data.frame':\t5 obs. of 2 variables: $ nome : chr \"João\" \"Maria\" \"Daniel\" \"Aline\" ... $ salario: int 1000 2500 2000 3000 3500 Confirmamos então que a coluna nome foi carregada como character e a coluna salario como integer, conforme esperado.\nCarregando arquivos do Excel Para carregar arquivos do Excel, faça o Download novamente da sua planilha no Google Sheets escolhendo a opção Microsoft Excel (.xlsx) e siga os comandos abaixo:\n\u003e install.packages(\"readxl\") # Instala o pacote necessário readxl \u003e library(readxl) # Carrega o pacote \u003e dados_excel = read_excel(file.choose()) \u003e dados_excel # A tibble: 5 × 2 nome salario \u003cchr\u003e \u003cdbl\u003e 1 João 1000 2 Maria 2500 3 Daniel 2000 4 Aline 3000 5 Mariana 3500 No comando acima, primeiro instalamos o pacote readxl que possui uma função read_excel() que nos permite trabalhar com arquivos excel. Em seguida, usamos o file.choose() como já explicado anteriormente para encontrar nosso arquivo excel. Note que quando listamos o conteúdo de dados_excel algumas informações adicionais aparecem, como a especificação do tipo de objeto tibble com suas dimensões e os tipos das colunas ( e ). Isso acontece pois a tibble é um formato mais moderno de data frame que gerencia melhor a memória em grandes volumes de dados. Felizmente, nada muda na forma de utilização comparado com o data frame tradicional.\n–\nNo próximo artigo vamos ver como calcular estatísticas descritivas do conjunto de dados e fazer uma verificação de qualidade mais profunda.\n","wordCount":"632","inLanguage":"pt","datePublished":"2024-11-15T00:00:00Z","dateModified":"2024-11-15T00:00:00Z","author":{"@type":"Person","name":"Danilo Scorzoni Ré"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dsre.dev/blog/05-carregando-dados-csv-excel/"},"publisher":{"@type":"Organization","name":"dsre.dev","logo":{"@type":"ImageObject","url":"https://dsre.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://dsre.dev/ accesskey=h title="dsre.dev (Alt + H)">dsre.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://dsre.dev/sobre/ title=Sobre><span>Sobre</span></a></li><li><a href=https://dsre.dev/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://dsre.dev/curriculo/ title=Currículo><span>Currículo</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Carregando dados do Excel e CSV</h1><div class=post-meta><span title='2024-11-15 00:00:00 +0000 UTC'>15 de novembro, 2024</span>&nbsp;·&nbsp;3 minutos&nbsp;·&nbsp;632 palavras&nbsp;·&nbsp;Danilo Scorzoni Ré</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/-BST5xCFBrQ?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p>Neste artigo vamos ver como carregar dados externos no R, seja por arquivos separados por vírgula (.csv - Comma Separated Values) ou por arquivos do Excel (.xlsx). Vamos começar criando um arquivo no Google Sheets para facilitar o acompanhamento deste tutorial:</p><p><img alt="Dados em uma planilha do Google Sheets" loading=lazy src=/blog/05-carregando-dados-csv-excel/google_sheets.png></p><p>Nesta planilha temos dados de nome e salários em duas colunas com 5 registros, semelhante aos dados do artigo anterior, mas são invés de adicionarmos os dados manualmente no R, vamos utilizar um arquivo externo.</p><p>Após preparar a tabela, você pode exportar o arquivo do Google Sheets escolhando um formato. Para isso, clique no menu Arquivo > Baixar > Valores separados por vírgulas (.csv) <strong>OU</strong> Microsoft Excel (.xlsx). Nesse artigo vou mostrar como importar nos dois formatos.</p><p><img alt="Exportando arquivos no Google Sheets" loading=lazy src=/blog/05-carregando-dados-csv-excel/google_exportar.png></p><h2 id=antes-de-carregar-como-encontrar-seus-arquivos>Antes de carregar, como encontrar seus arquivos<a hidden class=anchor aria-hidden=true href=#antes-de-carregar-como-encontrar-seus-arquivos>#</a></h2><p>Existe uma função no R que abre uma caixa de diálogo que auxilia você a encontrar um arquivo no seu computador. Trata-se da função <code>file.choose()</code>. O retorno dela é o caminho completo do arquivo escolhido no computador. Então você pode utilizar essa função em conjunto com as demais funções de carregamento de arquivos.</p><p>Assista ao vídeo no topo deste artigo para ver essa função em ação.</p><h2 id=carregando-arquivos-csv>Carregando arquivos CSV<a hidden class=anchor aria-hidden=true href=#carregando-arquivos-csv>#</a></h2><p>Vamos começar carregando o arquivo CSV então. Após baixá-lo do Google Sheets, basta utilizar os seguintes comandos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>dados_csv</span> <span class=o>=</span> <span class=nf>read.csv</span><span class=p>(</span><span class=nf>file.choose</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>dados_csv</span>
</span></span><span class=line><span class=cl>     <span class=n>nome</span> <span class=n>salario</span>
</span></span><span class=line><span class=cl><span class=m>1</span>    <span class=n>João</span>    <span class=m>1000</span>
</span></span><span class=line><span class=cl><span class=m>2</span>   <span class=n>Maria</span>    <span class=m>2500</span>
</span></span><span class=line><span class=cl><span class=m>3</span>  <span class=n>Daniel</span>    <span class=m>2000</span>
</span></span><span class=line><span class=cl><span class=m>4</span>   <span class=n>Aline</span>    <span class=m>3000</span>
</span></span><span class=line><span class=cl><span class=m>5</span> <span class=n>Mariana</span>    <span class=m>3500</span>
</span></span></code></pre></div><blockquote><p><strong>IMPORTANTE:</strong> Caso seu arquivo possua números com casas decimais, você precisa verificar como está a configuração do seu computador. Abra o arquivo em um editor de textos como o Bloco de Notas e verifique a estrutura do arquivo. Caso as casas decimais sejam representadas por pontos (.) como no sistema inglês de unidades, você pode usar a função <code>read.csv()</code>, caso as casas decimais sejam representadas por vírgulas (,) como no sistema internacional de unidades, você deve utilizar a função <code>read.csv2()</code>. Isso é fundamental para evitar que o R misture as vírgulas que separam casas decimais com as vírgulas que separam as colunas. Quando a casa decimal é especificada pela vírgula, as colunas serão separadas por ponto-e-vírgula (;).</p></blockquote><p>Além de verificar se os dados foram carregados de forma correta, é importante também verificar se os tipos estão corretos. Então, para isso, vamos utilizar a função <code>str()</code> já citada nos artigos anteriores para conhecer a estrutura do data frame:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>str</span><span class=p>(</span><span class=n>dados_csv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s>&#39;data.frame&#39;</span><span class=o>:</span>	<span class=m>5</span> <span class=n>obs.</span> <span class=n>of</span>  <span class=m>2</span> <span class=n>variables</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>nome</span>   <span class=o>:</span> <span class=n>chr</span>  <span class=s>&#34;João&#34;</span> <span class=s>&#34;Maria&#34;</span> <span class=s>&#34;Daniel&#34;</span> <span class=s>&#34;Aline&#34;</span> <span class=kc>...</span>
</span></span><span class=line><span class=cl> <span class=o>$</span> <span class=n>salario</span><span class=o>:</span> <span class=n>int</span>  <span class=m>1000</span> <span class=m>2500</span> <span class=m>2000</span> <span class=m>3000</span> <span class=m>3500</span>
</span></span></code></pre></div><p>Confirmamos então que a coluna nome foi carregada como <code>character</code> e a coluna salario como <code>integer</code>, conforme esperado.</p><h2 id=carregando-arquivos-do-excel>Carregando arquivos do Excel<a hidden class=anchor aria-hidden=true href=#carregando-arquivos-do-excel>#</a></h2><p>Para carregar arquivos do Excel, faça o Download novamente da sua planilha no Google Sheets escolhendo a opção Microsoft Excel (.xlsx) e siga os comandos abaixo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;readxl&#34;</span><span class=p>)</span> <span class=c1># Instala o pacote necessário readxl</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nf>library</span><span class=p>(</span><span class=n>readxl</span><span class=p>)</span> <span class=c1># Carrega o pacote</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>dados_excel</span> <span class=o>=</span> <span class=nf>read_excel</span><span class=p>(</span><span class=nf>file.choose</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>dados_excel</span>
</span></span><span class=line><span class=cl><span class=c1># A tibble: 5 × 2</span>
</span></span><span class=line><span class=cl>  <span class=n>nome</span>    <span class=n>salario</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=n>chr</span><span class=o>&gt;</span>     <span class=o>&lt;</span><span class=n>dbl</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=m>1</span> <span class=n>João</span>       <span class=m>1000</span>
</span></span><span class=line><span class=cl><span class=m>2</span> <span class=n>Maria</span>      <span class=m>2500</span>
</span></span><span class=line><span class=cl><span class=m>3</span> <span class=n>Daniel</span>     <span class=m>2000</span>
</span></span><span class=line><span class=cl><span class=m>4</span> <span class=n>Aline</span>      <span class=m>3000</span>
</span></span><span class=line><span class=cl><span class=m>5</span> <span class=n>Mariana</span>    <span class=m>3500</span>
</span></span></code></pre></div><p>No comando acima, primeiro instalamos o pacote <code>readxl</code> que possui uma função <code>read_excel()</code> que nos permite trabalhar com arquivos excel. Em seguida, usamos o <code>file.choose()</code> como já explicado anteriormente para encontrar nosso arquivo excel. Note que quando listamos o conteúdo de <code>dados_excel</code> algumas informações adicionais aparecem, como a especificação do tipo de objeto <code>tibble</code> com suas dimensões e os tipos das colunas (<code>&lt;chr></code> e <code>&lt;dbl></code>). Isso acontece pois a tibble é um formato mais moderno de data frame que gerencia melhor a memória em grandes volumes de dados. Felizmente, nada muda na forma de utilização comparado com o data frame tradicional.</p><p>&ndash;</p><p>No próximo artigo vamos ver como calcular estatísticas descritivas do conjunto de dados e fazer uma verificação de qualidade mais profunda.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://dsre.dev/tags/basico/>Basico</a></li><li><a href=https://dsre.dev/tags/excel/>Excel</a></li><li><a href=https://dsre.dev/tags/google-sheets/>Google Sheets</a></li></ul><nav class=paginav><a class=prev href=https://dsre.dev/blog/06-flashit/><span class=title>« Página Anterior</span><br><span>FlashIt! Uma ferramenta para criação rápida de Flashcards</span>
</a><a class=next href=https://dsre.dev/blog/04-filtros-vetores-data-frames/><span class=title>Próxima Página »</span><br><span>Filtros em vetores e data frames</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://dsre.dev/>dsre.dev</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>